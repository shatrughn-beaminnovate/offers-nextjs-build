"use strict";(()=>{var e={};e.id=666,e.ids=[666,888],e.modules={1625:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>g,default:()=>m,getServerSideProps:()=>h,getStaticPaths:()=>p,getStaticProps:()=>u,reportWebVitals:()=>f,routeModule:()=>S,unstable_getServerProps:()=>x,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>_,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>v});var s=r(7093),i=r(5244),o=r(1323),n=r(9981),c=r(9413),l=r(147),d=e([c,l]);[c,l]=d.then?(await d)():d;let m=(0,o.l)(l,"default"),u=(0,o.l)(l,"getStaticProps"),p=(0,o.l)(l,"getStaticPaths"),h=(0,o.l)(l,"getServerSideProps"),g=(0,o.l)(l,"config"),f=(0,o.l)(l,"reportWebVitals"),v=(0,o.l)(l,"unstable_getStaticProps"),y=(0,o.l)(l,"unstable_getStaticPaths"),_=(0,o.l)(l,"unstable_getStaticParams"),x=(0,o.l)(l,"unstable_getServerProps"),w=(0,o.l)(l,"unstable_getServerSideProps"),S=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/upgrade/[phoneID]",pathname:"/upgrade/[phoneID]",bundlePath:"",filename:""},components:{App:c.default,Document:n.default},userland:l});a()}catch(e){a(e)}})},147:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>v,getServerSideProps:()=>f});var s=r(997),i=r(5675),o=r.n(i),n=r(1163),c=r(6689),l=r(3590),d=r(3554),m=r(9066),u=r(968),p=r.n(u),h=r(6670),g=e([l,d,m,h]);async function f(e){let t="https://lmsservice.unicornstore.in",{phoneID:r}=e.query,a="",s="",i="",o="";try{let e=await fetch(`${t}/get-meta-form-by-slug/?slug=${r}`);if(!e.ok)throw Error("Could not get current product");if(a=await e.json(),"success"!==a.status)throw Error(a.message);let n=await fetch(`${t}/get-all-states`);if(!n.ok)throw Error("Could not get states");if(s=await n.json(),"success"!==s.status)throw Error(s.message);let c=await fetch(`${t}/get-city-by-state`);if(!c.ok)throw Error("Could not get cities");if(i=await c.json(),"success"!==i.status)throw Error(i.message);let l=await fetch(`${t}/get-store-by-city`);if(!l.ok)throw Error("Could not get Stores");if(o=await l.json(),"success"!==o.status)throw Error(o.message);return{props:{seoTitle:a.form_data.title||"",description:a.form_data.description||"",productTitle:a.form_data.product_title||"",keywords:a.form_data.keyword||"",imageUrl:a.form_data.image_url||"",formName:a.form_data.form_name||"",formID:a.form_data.form_type||"",stateList:s&&s.data.map(e=>({value:e.state_id,label:e.state_name}))||"",cityList:i&&i.data.map(e=>({value:e.city_id,label:e.city_name,state_id:e.state_id}))||"",storeList:o&&o.data.map(e=>({value:e.store_id,label:e.store_name,state_id:e.state_id,city_id:e.city_id}))||"",pageData:a.form_data}}}catch(e){return console.log(e.message),{props:{pageError:e.message}}}}[l,d,m,h]=g.then?(await g)():g;let v=e=>{let{seoTitle:t,productTitle:r,imageUrl:a,formID:i,stateList:d,cityList:u,storeList:g,pageError:f,pageData:v}=e,y="https://lmsservice.unicornstore.in",_=(0,n.useRouter)(),x=_.query,[w,S]=(0,c.useState)({name:"",email:"",phone:"",otp:"",state:"",city:"",store:"",device_type:v.device_type??"",device_name:v.device_name??"",device_variant:v.device_variant??""}),[b,j]=(0,c.useState)(!1),[P,q]=(0,c.useState)({}),[C,E]=(0,c.useState)(!1),[N,k]=(0,c.useState)(u),[T,O]=(0,c.useState)(g),[I,$]=(0,c.useState)({category:[{label:"",value:""}],model:[{label:"",value:""}],variant:[{label:"",value:""}]});(0,c.useEffect)(()=>{if(w.state){let e=u.filter(e=>e.state_id===parseInt(w.state));k(e)}else k([])},[w.state,u]),(0,c.useEffect)(()=>{if(console.log({stateList:d,cityList:u,storeList:g}),w.city){let e=g.filter(e=>e.city_id===parseInt(w.city));O(e),e.find(e=>e.value===w.store)||S(e=>({...e,store:""}))}else if(w.state){let e=g.filter(e=>e.state_id===w.state);O(e)}else O(g)},[w.city,w.state,g]);let D=e=>{let{name:t,value:r}=e.target;S({...w,[t]:r}),q(e=>{let a={...e};return"name"!==t||r.trim()?"name"===t&&(a.name=""):a.name="Name is required","email"===t&&(r.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?a.email="":a.email="Email is invalid":a.email="Email is required"),"phone"!==t||r.trim()?"phone"===t&&(a.phone=""):a.phone="Phone Number is required","otp"!==t||r.trim()?"otp"===t&&(a.otp=""):a.otp="OTP is required","state"!==t||r?"state"===t&&(a.state=""):a.state="State is required","device_type"===t&&(r?a.device_type="":a.device_type="Product Category is required"),"device_name"===t&&(r?a.device_name="":a.device_name="Model is required"),"device_variant"===t&&(r?a.device_variant="":a.device_variant="Variant is required"),a})},V=(e,t)=>{let r=e?.value;S(e=>({...e,[t]:r}))};(0,c.useEffect)(()=>{localStorage.removeItem("customer-id"),localStorage.setItem("form-type",i),L()},[]);let F=async()=>{E(!0);try{let e=await fetch(`${y}/send-otp?phone_number=${w.phone}`,{method:"POST"});if(!e.ok)throw Error("Could not generate OTP");let t=await e.json();"success"===t.status?(j(!0),setTimeout(()=>{j(!1)},2500)):l.toast.warn(t.reason,{toastId:"warnToast"})}catch(e){console.log(e),l.toast.error(e.message,{toastId:"errorToast"})}E(!1)},M=()=>{let e={};return w.name.trim()||(e.name="Name is required"),w.phone.trim()||(e.phone="Phone Number is required"),w.otp.trim()||(e.otp="OTP is required"),w.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(w.email)||(e.email="Email is invalid"):e.email="Email is required",""===w.product&&(e.product="Product is required"),""===w.state&&(e.state="State is required"),""===w.device_type&&(e.device_type="Product Category is required"),""===w.device_name&&(e.device_name="Model is required"),""===w.device_variant&&(e.device_variant="Variant is required"),q(e),0===Object.keys(e).length},J=async e=>{if(e.preventDefault(),M())try{let e=await fetch(`${y}/create-form-submission/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:{...w,form_name:i,url_data:x}})});if(!e.ok)throw Error("Could not create form");let t=await e.json();"success"!==t.status&&l.toast.info(t.message,{toastId:"infoMessage"}),"success"===t.status&&"form-2"===i?(localStorage.setItem("customer-id",t.form_id),_.push(`${x.phoneID}/payment`)):"success"===t.status&&"form-1"===i&&_.push(`${x.phoneID}/thanks`)}catch(e){console.log(e),l.toast.error("Could not create form")}};(0,c.useEffect)(()=>{w.device_type||S(e=>({...e,device_name:null})),w.device_name||S(e=>({...e,device_variant:null}))},[w.device_type,w.device_name]);let L=async()=>{try{let e=await fetch(`${y}/get-device-hierarchy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!e.ok)throw Error("Could not get product categories");let t=await e.json();if("success"!==t.status)throw Error(t.message);$(e=>({...e,category:t.top_level}))}catch(e){l.toast.error(e.message)}},G=async()=>{try{let e=await fetch(`${y}/get-device-hierarchy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_type:w.device_type})});if(!e.ok)throw Error("Could not get product categories");let t=await e.json();if("success"!==t.status)throw Error(t.message);$(e=>({...e,model:t.device_names}))}catch(e){l.toast.error(e.message)}},R=async()=>{try{let e=await fetch(`${y}/get-device-hierarchy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_type:w.device_type,device_name:w.device_name})});if(!e.ok)throw Error("Could not get product categories");let t=await e.json();if("success"!==t.status)throw Error(t.message);$(e=>({...e,variant:t.device_variants}))}catch(e){l.toast.error(e.message)}};return((0,c.useEffect)(()=>{w.device_type&&G()},[w.device_type]),(0,c.useEffect)(()=>{w.device_name&&R()},[w.device_name]),f)?s.jsx("div",{className:"w-screen flex justify-center items-center mt-20 ",children:(0,s.jsxs)("div",{className:"container max-w-screen-lg bg-white shadow-lg rounded-lg p-8 text-red-500 text-center space-y-4",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("i",{className:"bi bi-exclamation-triangle-fill text-red-500 text-6xl"})}),s.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Oops! Something went wrong."}),s.jsx("p",{className:"text-lg text-gray-600",children:"We encountered an error while trying to fetch the data."}),s.jsx("p",{children:f}),s.jsx("button",{className:"bg-red-500 text-white font-semibold px-6 py-3 rounded-full hover:bg-red-600 transition duration-300",onClick:()=>_.reload(),children:"Retry"})]})}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(p(),{children:s.jsx("title",{children:t})}),s.jsx("div",{className:"w-screen flex justify-center mt-6 sm:mt-0",children:(0,s.jsxs)("div",{className:"container max-w-screen-xl grid grid-cols-2 gap-x-5 gap-y-5",children:[s.jsx("div",{className:"col-span-2",children:(0,s.jsxs)("p",{className:"text-3xl font-semibold text-center",children:["form-1"===i&&"Upgrade","form-2"===i&&"Prebook"," ",r]})}),s.jsx("div",{className:"flex justify-center items-center col-span-2 sm:col-span-1 ",children:s.jsx(o(),{className:"max-w-48 sm:max-w-none h-full object-contain w-full",src:a||"/ImageNotFound.png",alt:"iPhone 15",width:350,height:100})}),(0,s.jsxs)("div",{className:"max-w-2xl  p-6 bg-white border border-gray-300 rounded col-span-2 sm:col-span-1 mx-2 sm:mx-0",children:["form-1"===i&&s.jsx(s.Fragment,{children:s.jsx(m.Z,{formData:w,errors:P,otpSentVisible:b,phoneList:[{label:"iPhone 12",value:"iPhone 12"}],currentStates:d,currentCities:N,currentStores:T,handleChange:D,handleGetOtp:F,handleFormSubmit:J,dropdownItems:I,handleSelectionChange:e=>t=>{D({target:{name:e,value:t}})},pageData:v})}),"form-2"===i&&s.jsx(h.Z,{formData:w,errors:P,otpSentVisible:b,handlePhoneChange:e=>{V(e,"product")},currentStates:d,currentCities:N,currentStores:T,handleChange:D,handleGetOtp:F,handleStateChange:e=>{V(e,"state")},handleCityChange:e=>{V(e,"city")},handleStoreChange:e=>{V(e,"store")},handleFormSubmit:J})]})]})})]})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2439:e=>{e.exports=import("@nextui-org/autocomplete")},220:e=>{e.exports=import("@nextui-org/button")},7127:e=>{e.exports=import("@nextui-org/navbar")},4723:e=>{e.exports=import("@nextui-org/spinner")},3554:e=>{e.exports=import("react-select")},3590:e=>{e.exports=import("react-toastify")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[388,490,803,413,959],()=>r(1625));module.exports=a})();