"use strict";(()=>{var e={};e.id=666,e.ids=[666,888],e.modules={1625:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>g,default:()=>m,getServerSideProps:()=>h,getStaticPaths:()=>p,getStaticProps:()=>u,reportWebVitals:()=>f,routeModule:()=>j,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>S,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>x});var s=r(7093),o=r(5244),i=r(1323),n=r(9981),l=r(9413),c=r(147),d=e([l,c]);[l,c]=d.then?(await d)():d;let m=(0,i.l)(c,"default"),u=(0,i.l)(c,"getStaticProps"),p=(0,i.l)(c,"getStaticPaths"),h=(0,i.l)(c,"getServerSideProps"),g=(0,i.l)(c,"config"),f=(0,i.l)(c,"reportWebVitals"),x=(0,i.l)(c,"unstable_getStaticProps"),y=(0,i.l)(c,"unstable_getStaticPaths"),S=(0,i.l)(c,"unstable_getStaticParams"),b=(0,i.l)(c,"unstable_getServerProps"),w=(0,i.l)(c,"unstable_getServerSideProps"),j=new s.PagesRouteModule({definition:{kind:o.x.PAGES,page:"/upgrade/[phoneID]",pathname:"/upgrade/[phoneID]",bundlePath:"",filename:""},components:{App:l.default,Document:n.default},userland:c});a()}catch(e){a(e)}})},147:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>x,getServerSideProps:()=>f});var s=r(997),o=r(5675),i=r.n(o),n=r(1163),l=r(6689),c=r(3590),d=r(3554),m=r(9066),u=r(968),p=r.n(u),h=r(6670),g=e([c,d,m,h]);async function f(e){let t="http://192.168.1.15:7000",{phoneID:r}=e.query,a="",s="",o="",i="",n="";try{let e=await fetch(`${t}/get-meta-form-by-slug/?slug=${r}`);if(!e.ok)throw Error("Could not get current product");a=await e.json(),console.log("Res",a);let n=await fetch(`${t}/get-all-states`);if(!n.ok)throw Error("Could not get states");s=await n.json();let l=await fetch(`${t}/get-city-by-state`);if(!l.ok)throw Error("Could not get cities");o=await l.json();let c=await fetch(`${t}/get-store-by-city`);if(!c.ok)throw Error("Could not get Stores");i=await c.json()}catch(e){console.log(e.message),n=e.message}return{props:{seoTitle:a.title||"",description:a.description||"",productTitle:a.product_title||"",keywords:a.keyword||"",imageUrl:a.image_url||"",formName:a.form_name||"",formID:a.form_type||"",phoneList:a.product_name?.map(e=>({label:e.Name,value:e.Name}))||"",stateList:s&&s.map(e=>({value:e.state_id,label:e.state_name}))||"",cityList:o&&o.map(e=>({value:e.city_id,label:e.city_name,state_id:e.state_id}))||"",storeList:i&&i.map(e=>({value:e.store_id,label:e.store_name,state_id:e.state_id,city_id:e.city_id}))||"",pageError:n||""}}}[c,d,m,h]=g.then?(await g)():g;let x=e=>{let{seoTitle:t,description:r,productTitle:a,keywords:o,imageUrl:d,formName:u,formID:g,phoneList:f,stateList:x,cityList:y,storeList:S,pageError:b}=e,w="http://192.168.1.15:7000",j=(0,n.useRouter)(),{query:_}=j,[v,P]=(0,l.useState)({name:"",email:"",phone:"",otp:"",product:"",state:"",city:"",store:""}),[C,N]=(0,l.useState)(!1),[q,k]=(0,l.useState)({}),[E,I]=(0,l.useState)(!1),[$,T]=(0,l.useState)(x),[O,D]=(0,l.useState)(y),[L,F]=(0,l.useState)(S);(0,l.useEffect)(()=>{if(v.state){let e=y.filter(e=>e.state_id===v.state);D(e),console.log("filteredCities",e)}else D([])},[v.state,y]),(0,l.useEffect)(()=>{if(v.city){let e=S.filter(e=>e.city_id===v.city);F(e),e.find(e=>e.value===v.store)||P(e=>({...e,store:""}))}else if(v.state){let e=S.filter(e=>e.state_id===v.state);F(e)}else F(S)},[v.city,v.state,S]);let R=e=>{let{name:t,value:r}=e.target;P({...v,[t]:r}),k(e=>{let a={...e};return"name"!==t||r.trim()?"name"===t&&(a.name=""):a.name="Name is required","email"===t&&(r.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?a.email="":a.email="Email is invalid":a.email="Email is required"),"phone"!==t||r.trim()?"phone"===t&&(a.phone=""):a.phone="Phone Number is required","otp"!==t||r.trim()?"otp"===t&&(a.otp=""):a.otp="OTP is required","state"!==t||r.trim()?"state"===t&&(a.state=""):a.state="State is required",a})},V=(e,t)=>{let r=e?.value;P(e=>({...e,[t]:r})),console.log(v)},G=e=>{V(e,"state")},M=e=>{V(e,"city")},W=e=>{V(e,"store")},A=e=>{V(e,"product")};(0,l.useEffect)(()=>{localStorage.removeItem("customer-id"),localStorage.setItem("form-type",g)},[]);let U=async()=>{I(!0);try{let e=await fetch(`${w}/send-otp?phone_number=${v.phone}`,{method:"POST"});if(!e.ok)throw Error("Could not generate OTP");let t=await e.json();"success"===t.status?(N(!0),setTimeout(()=>{N(!1)},2500)):c.toast.warn(t.reason,{toastId:"warnToast"})}catch(e){console.log(e),c.toast.error(e.message,{toastId:"errorToast"})}I(!1)},Z=()=>{let e={};return v.name.trim()||(e.name="Name is required"),v.phone.trim()||(e.phone="Phone Number is required"),v.otp.trim()||(e.otp="OTP is required"),v.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v.email)||(e.email="Email is invalid"):e.email="Email is required",""===v.product&&(e.product="Product is required"),""===v.state&&(e.state="State is required"),k(e),0===Object.keys(e).length},z=async e=>{if(e.preventDefault(),Z())try{let e=await fetch(`${w}/create-form-submission`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:{...v,form_name:u,url_data:_}})});if(!e.ok)throw Error("Could not create form");let t=await e.json();"success"!==t.status&&c.toast.info(t.message,{toastId:"infoMessage"}),"success"===t.status&&"form-2"===g?(localStorage.setItem("customer-id",t.form_id),j.push(`${_.phoneID}/payment`)):"success"===t.status&&"form-1"===g&&j.push(`${_.phoneID}/thanks`)}catch(e){console.log(e),c.toast.error("Could not create form")}};return b?s.jsx("div",{className:"w-screen flex justify-center items-center mt-20 ",children:(0,s.jsxs)("div",{className:"container max-w-screen-lg bg-white shadow-lg rounded-lg p-8 text-red-500 text-center space-y-4",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("i",{className:"bi bi-exclamation-triangle-fill text-red-500 text-6xl"})}),s.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Oops! Something went wrong."}),s.jsx("p",{className:"text-lg text-gray-600",children:"We encountered an error while trying to fetch the data."}),s.jsx("button",{className:"bg-red-500 text-white font-semibold px-6 py-3 rounded-full hover:bg-red-600 transition duration-300",onClick:()=>j.reload(),children:"Retry"})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p(),{children:[s.jsx("title",{children:t}),r&&s.jsx("meta",{name:"description",content:r}),o&&s.jsx("meta",{name:"keywords",content:o})]}),s.jsx("div",{className:"w-screen flex justify-center mt-6 sm:mt-0",children:(0,s.jsxs)("div",{className:"container max-w-screen-xl grid grid-cols-2 gap-x-5 gap-y-5",children:[s.jsx("div",{className:"col-span-2",children:(0,s.jsxs)("p",{className:"text-3xl font-semibold text-center",children:["form-1"===g&&"Upgrade","form-2"===g&&"Prebook"," ",a]})}),s.jsx("div",{className:"flex justify-center items-center col-span-2 sm:col-span-1 ",children:s.jsx(i(),{className:"max-w-48 sm:max-w-none",src:d||"/ImageNotFound.png",alt:"iPhone 15",width:350,height:100})}),(0,s.jsxs)("div",{className:"max-w-2xl  p-6 bg-white border border-gray-300 rounded col-span-2 sm:col-span-1 mx-2 sm:mx-0",children:["form-1"===g&&s.jsx(m.Z,{formData:v,errors:q,otpSentVisible:C,phoneList:f,handlePhoneChange:A,currentStates:$,currentCities:O,currentStores:L,handleChange:R,handleGetOtp:U,handleStateChange:G,handleCityChange:M,handleStoreChange:W,handleFormSubmit:z}),"form-2"===g&&s.jsx(h.Z,{formData:v,errors:q,otpSentVisible:C,handlePhoneChange:A,currentStates:$,currentCities:O,currentStores:L,handleChange:R,handleGetOtp:U,handleStateChange:G,handleCityChange:M,handleStoreChange:W,handleFormSubmit:z})]})]})})]})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},3554:e=>{e.exports=import("react-select")},3590:e=>{e.exports=import("react-toastify")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[388,490,803,413,959],()=>r(1625));module.exports=a})();